class Solution {
public:
    vector<int> ans, count;
    vector<vector<int>> adj;
    int n;

    void dfs1(int node, int parent) {
        count[node] = 1;
        
        for (int child : adj[node]) {
            if (child == parent) continue;
            dfs1(child, node);

            // the number of children for this node
            // so this calculates the subtree
            count[node] += count[child];

            // so ans[0] - will store sometjing like this
            // ans[0] = count[3]+count[4]+count[5]+count[2]...
            // so if we see - 1+1+1+4 - 7 i.e the time

            ans[0] += count[child]; // distance from root to this child subtree
        }
    }

    
    void dfs2(int node, int parent) {
        
        for (int child : adj[node]) {
            if (child == parent) continue;
            ans[child] = ans[node] - count[child] + (n - count[child]);
            dfs2(child, node);
        }
    }

    vector<int> sumOfDistancesInTree(int N, vector<vector<int>>& edges) {

        adj.assign(N,{});
        n=N;

        for(int i=0;i<edges.size();i++){
            adj[edges[i][0]].push_back(edges[i][1]);
            adj[edges[i][1]].push_back(edges[i][0]);
        }

        ans.assign(n, 0);
        count.assign(n, 0);

         // first pass: count nodes & sum for root
        dfs1(0, -1);

        // second pass: reroot
        dfs2(0, -1);

        return ans;
        
    }
};

// each node will be returning (child count,dis)

//         0 
//     ((2,1),(3,2)) 

//      1         2
//    (0,1)     (3,1)

//            3      4      5
//          (0,1)   (0,1)  (0,1)


//  formuala would be

//  lets say for 2 how do we calculate

//  its child list - (3,1)  and its parent list - (2,1) (3,2) , but we need to remove 1 node at the distamce of itself thats included in the parent.i.e


//  (2,1) - denotes we have 2 children with dis 1
//  but we have calulcate child 2 also, for 2 we ned to remove this right

// and all the other children of parents are 1 step farther
// and all children of parent of subtree are 1 step near




